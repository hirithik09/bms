{% extends "base.html" %} {% block title %}Authors{% endblock %} {% block
content %}

<h3>Authors</h3>
<style>
  .is-invalid {
    border-color: #dc3545 !important;
    box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
  }

  label.error {
    color: #dc3545;
    font-size: 0.875em;
    margin-top: 0.25rem;
    display: block;
  }
  .select2-container .select2-selection--single {
    height: 38px !important;
    padding: 6px 12px;
    border: 1px solid #ced4da;
    border-radius: 0.375rem;
  }

  .select2-container--default
    .select2-selection--single
    .select2-selection__rendered {
    line-height: 24px;
  }

  .select2-container--default
    .select2-selection--single
    .select2-selection__arrow {
    height: 36px;
    right: 10px;
  }
</style>

<!-- Dependencies -->
<script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.validate.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jsdelivr.bootstrap.js') }}"></script>
<script src="{{ url_for('static', filename='js/datatable.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/sweetalert.js') }}"></script>
<script src="{{ url_for('static', filename='js/author.js') }}"></script>
<p class="text-end">
  <a href="#" class="btn btn-primary" id="add_record">Add</a>
</p>

<table id="userTable" class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>Id</th>
      <th>Author</th>
      <th>Genre</th>
      <th>Status</th>
      <th>Created At</th>
      <th>Updated At</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    {% for author in authors %}
    <tr data-id="{{ author.id }}" data-genre-id="{{ author.category_id }}">
      <td>{{ author.id }}</td>
      <td>{{ author.author_name }}</td>
      <td>{{ author.book_category}}</td>
      {# joined category name from category table #}
      <td>
        <div class="form-check form-switch">
          <input class="form-check-input status-toggle" type="checkbox"
          role="switch" {% if author.status == 1 or author.status == '1' %}
          checked {% endif %}>
        </div>
      </td>
      <td class="created-at">{{ author.created_date }}</td>
      <td class="updated-at">{{ author.updated_date }}</td>
      <td>
        <button class="btn btn-sm btn-primary update-btn">Edit</button>
        <button class="btn btn-sm btn-danger delete-btn">Delete</button>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- Modal -->
<div
  class="modal fade"
  id="genreModal"
  tabindex="-1"
  aria-labelledby="genreModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <form id="genreForm">
        <div class="modal-header">
          <h5 class="modal-title" id="genreModalLabel">Add Author</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="genreId" />
          <div class="mb-3">
            <label for="authorNameInput" class="form-label"
              >Author Name <span style="color: #dc3545">*</span></label
            >
            <input
              type="text"
              class="form-control"
              id="authorNameInput"
              name="authorNameInput"
            />
          </div>
          <div class="mb-3">
            <label for="categorySelect" class="form-label"
              >Genre <span style="color: #dc3545">*</span></label
            >
            <select
              class="form-select"
              id="categorySelect"
              name="categorySelect"
            >
              <option value="" disabled selected>Select Genre</option>
              {% for category in categories %}
              <option value="{{ category.id }}">
                {{ category.book_category }}
              </option>
              {% endfor %}
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Save</button>
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Toast Container (Top Right) -->
<div class="position-fixed top-0 end-0 p-3" style="z-index: 1100">
  <div
    id="toast"
    class="toast align-items-center text-white bg-primary border-0"
    role="alert"
    aria-live="assertive"
    aria-atomic="true"
  >
    <div class="d-flex">
      <div class="toast-body" id="toast-body"></div>
      <button
        type="button"
        class="btn-close btn-close-white me-2 m-auto"
        data-bs-dismiss="toast"
        aria-label="Close"
      ></button>
    </div>
  </div>
</div>
<link
  href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
  rel="stylesheet"
/>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
{% endblock %}
